---
title: 第七章 递推关系和生成函数
---

## 生成函数

什么样的数列，生成函数是如下式子

```am
(1+x+x^2+x^3+x^4+x^5)(1+x+x^2)(1+x+x^2+x^3+x^4)
```

> [!note] 解
> - $x^(e_1) (0<=e_1<=5),x^(e_2) (0<=e_2<=2),x^(e_3) (0<=e_3<=4)$ 分别是第一个、第二个、第三个因子
> - 假设 $e_1+e_2+e_3=n$，则 $x^(e_1)x^(e_2)x^(e_3)=x^n$
> - $x^n$ 的系数是 $e_1+e_2+e_3=n$ 的整数解的个数 $h_n$，其中 $e_1,e_2,e_3$ 满足上述的范围

确定 Apple, Banana, Orange, Pear 的 $n$ 组合数，Apple 偶数，Banana 奇数，Orange $in [0, 4]$，Pear $>=1$

> [!note] 解
> - 等价于接触 $a+b+c+d=n$ 的非负整数解的个数 $h_n$，分别满足上述条件
> - 为每种水果创建一个因子，其中的指数为该类型水果的 $n$ 组合中允许的数量

$$
g(x)&=(1+x^2+x^4+...)

&*(x+x^3+x^5+...)

&*(1+x+x^2+x^3+x^4)

&*(x+x^2+x^3+...)

&=1/(1-x^2)x/(1-x^2) (1-x^5)/(1-x) x/(1-x)

&=(x^2(1-x^5))/((1-x^2)^2(1-x)^2)
$$

类似的，Apple 偶数，Banana 5 的倍数，Orange 不超过 4 个，Pear 最多一个

```am
g(x)&=(1+x^2+x^4+...)(1+x^5+x^10+...)(1+x+x^2+x^3+x^4)(1+x)

&=1/(1-x)^2=sum_(n=0)^oo (n+1) choose n x^n 

&= sum_(n=0)^oo (n+1)x^n
```

## 指数生成函数

```am
g^((e)) (x)& =sum_(n=0)^oo h_n x^n/n!

&=h_0+h_1 x+h_2 x^2/2! + h_3 x^3/3! + h_n x^n/n! + ...
```

- 数列 ${a_n=1}$ 的指数生成函数为 $g^((e))(x)=sum_(n=0)^oo x^n/n! =e^x$
- 数列 ${1, a, a^2, ...}$ 的指数生成函数为 $sum_(n=0)^oo a^n x^n/n! =e^(ax)$

> [!note] 定理 7.3.1
> 
>$h_n$ 是多重集合 $S={n_1*a_1,...,n_k*a_k}$ 的 $n$ 排列数，则数列 ${h_n}$ 的指数生成函数
> 
> ```am
> g^((e))(x)=f_(n_1)(x)f_(n_2)(x) ... f_(n_k)(x)
> ```
> 
> 其中 $f_(n_i)(x)=1+x+x^2/2!+...+x^(n_i)/n_i !$

展开 $g^((e))(x)$ 得到项

```am
x^(m_1)/m_1 ! x^(m_2)/m_2 ! ... x^(m_k)/m_k ! = x^(m_1+...+m_k)/(m_1!m_2!...m_k!) = n!/(m_1!m_2!...m_k!) x^n/n!
```

其中 $n=Sigma m$，$0<=m_1<=n_1, ..., 0<=m_k<=n_k$

$x^n/n!$ 的系数是 $sum n!/(m_1!m_2!...m_k!)$

$S$ 的组合 ${m_1*a_1,...,m_k*a_k}$ 的排列数为 $n!/(m_1!m_2!...m_k!)$

例：$h_n$ 表示由数字 1, 2, 3 构造的 $n$ 位数的个数，1 有偶数个，2 至少有三个，3 最多四个，确定指数生成函数

> [!example] 解
>
> ```am
> h_1(x) &= 1 + x^2/2! + x^4/4! + ...
> 
> h_2(x) &= x^3/3! + x^4/4! + x^5/5! ...
> 
> h_3(x) &= 1 + x + x^2/2! + x^3/3! + x^4/4!
> ```
> 
> $$
> g^((e))(x)=h_1(x)h_2(x)h_3(x)
> $$

例：确定满足条件的 $n$ 位数的个数 $h_n$：每个数字都是奇数，且数字 1 和 3 出现次数为偶数

> [!example] 解
> $h_n$ 等于多重集合 ${oo*1,oo*3, oo*5,oo*7,oo*9}$ 的 $n$ 排列中 1, 3 出现偶数次的 $n$ 排列数
> 
> $$
> g^((e))(x) & = (1+x^2/2!+x^4/4!+...)^2(1+x+x^2/2!+...)^3
> 
> &=((e^x+e^-x)/2)^2e^(3x)
> 
> &=1/4(e^(5x)+2e^(3x)+e^x)
> 
> &=1/4 (sum 5^n x^n/n! +2 sum 3^n x^n/n! + sum x^n/n!)
> 
> &=sum_(n=0)^oo ((5^n+2 xx 3^n + 1)/4)x^n/n!
> $$
> 
> $h_n=(5^n+2 xx 3^n + 1)/4$


